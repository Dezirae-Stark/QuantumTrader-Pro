# GitLeaks Configuration for QuantumTrader Pro
# https://github.com/gitleaks/gitleaks

title = "QuantumTrader Pro Secret Scanning Configuration"

[extend]
# useDefault will extend the base configuration with the default gitleaks config:
# https://github.com/gitleaks/gitleaks/blob/master/config/gitleaks.toml
useDefault = true

[allowlist]
description = "Allowlisted files and patterns"
paths = [
  '''node_modules/''',
  '''\.git/''',
  '''build/''',
  '''\.gradle/''',
  '''\.dart_tool/''',
  '''\.idea/''',
  '''\.github/WORKFLOW_SECURITY\.md''',  # Workflow security documentation with examples
  '''mql5/README\.md''',  # MQL5 documentation with example auth headers
  '''DESKTOP_SETUP\.md''',  # Desktop setup guide with example auth headers
  '''README\.md''',  # Main README with example auth headers
  '''PRODUCTION_READINESS\.md''',  # Production readiness guide with demo credentials
  '''\.env\.example''',  # Environment variable example file
  '''bridge/\.env\.example''',  # Bridge environment variable example file
  '''docs/GITHUB_SECRETS\.md''',  # GitHub secrets documentation with examples
  '''docs/BACKTESTING\.md''',  # Backtesting documentation with demo credentials
  '''docs/ENVIRONMENT_SETUP\.md''',  # Environment setup guide with demo credentials
  '''docs/security/bridge-server-security\.md''',  # Security documentation with example tokens
]

# Example patterns (non-sensitive) to allowlist
regexes = [
  '''example\.com''',
  '''localhost''',
  '''127\.0\.0\.1''',
  '''example-api-key''',  # Example API keys in documentation
  '''Bearer\s+your-api-token-here''',  # Example bearer tokens
]

# Custom rules for QuantumTrader Pro specific secrets

[[rules]]
id = "lhfx-demo-credentials"
description = "LHFX Demo Account Credentials"
regex = '''(?i)(194302|ajty2ky)'''
tags = ["lhfx", "demo", "credential"]
[rules.allowlist]
paths = [
  '''SECURITY-ADVISORY-2025-001\.md''',  # Advisory document references
  '''SECURITY\.md''',  # Security policy references
  '''\.gitleaks\.toml''',  # This config file
  '''bridge/README\.md''',  # Bridge documentation with demo credentials
  '''backtest/README\.md''',  # Backtest documentation with demo credentials
  '''mql5/README\.md''',  # MQL5 documentation with demo credentials
  '''lib/screens/account_login_screen\.dart''',  # Login screen with demo hints
  '''backtest/lhfx_backtest\.py''',  # Backtest script with demo credentials
  '''QUICK_START\.md''',  # Quick start guide with demo credentials
]

[[rules]]
id = "generic-password"
description = "Generic Password Patterns"
regex = '''(?i)(password|passwd|pwd)\s*[:=]\s*['"][^'"]{8,}['"]'''
tags = ["password", "credential"]
[rules.allowlist]
paths = [
  '''docs/''',  # Documentation examples
  '''test/''',  # Test fixtures
  '''CONTRIBUTING\.md''',  # Contributing guide with examples
]

[[rules]]
id = "api-token"
description = "API Token or Secret"
regex = '''(?i)(api[_-]?key|api[_-]?token|access[_-]?token|secret[_-]?key)\s*[:=]\s*['"][a-zA-Z0-9]{20,}['"]'''
tags = ["api", "token", "key"]

[[rules]]
id = "private-key"
description = "Private Key Pattern"
regex = '''-----BEGIN\s+(RSA\s+|EC\s+|OPENSSH\s+)?PRIVATE KEY-----'''
tags = ["private-key", "pem"]

[[rules]]
id = "aws-access-key"
description = "AWS Access Key"
regex = '''AKIA[0-9A-Z]{16}'''
tags = ["aws", "access-key"]

[[rules]]
id = "github-token"
description = "GitHub Personal Access Token"
regex = '''ghp_[a-zA-Z0-9]{36}'''
tags = ["github", "pat"]

[[rules]]
id = "jwt-token"
description = "JWT Token"
regex = '''eyJ[a-zA-Z0-9_-]+\.eyJ[a-zA-Z0-9_-]+\.[a-zA-Z0-9_-]+'''
tags = ["jwt", "token"]
[rules.allowlist]
paths = [
  '''test/''',
  '''examples/''',
]
