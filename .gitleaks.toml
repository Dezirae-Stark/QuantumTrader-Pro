# Gitleaks Configuration for QuantumTrader-Pro
#
# This file configures secret scanning to detect:
# - API keys and tokens
# - Passwords and credentials
# - Private keys
# - Authentication secrets
#
# Documentation: https://github.com/gitleaks/gitleaks

title = "QuantumTrader-Pro Secret Scanning"

[extend]
# Use default Gitleaks rules as baseline
useDefault = true

# Custom rules for Android/Flutter specific secrets
[[rules]]
id = "android-keystore-password"
description = "Android Keystore Password"
regex = '''(?i)(keyPassword|storePassword)\s*=\s*['""].{8,}['"]'''
tags = ["android", "keystore", "password"]

[[rules]]
id = "android-keystore-properties"
description = "Android Key Properties File"
regex = '''(?i)(keyAlias|storeFile)\s*=\s*['""].+['"]'''
tags = ["android", "keystore"]
path = '''.*key\.properties$'''

[[rules]]
id = "flutter-api-key"
description = "API Key in Flutter/Dart code"
regex = '''(?i)(api[_-]?key|apikey)\s*[:=]\s*['""][a-zA-Z0-9_\-]{16,}['"]'''
tags = ["api", "key", "flutter"]

[[rules]]
id = "telegram-token"
description = "Telegram Bot Token"
regex = '''[0-9]{8,10}:[a-zA-Z0-9_-]{35}'''
tags = ["telegram", "token"]

[[rules]]
id = "jwt-token"
description = "JWT Token"
regex = '''eyJ[a-zA-Z0-9_-]+\.eyJ[a-zA-Z0-9_-]+\.[a-zA-Z0-9_-]+'''
tags = ["jwt", "token"]

[[rules]]
id = "private-key"
description = "Private Key (PEM format)"
regex = '''-----BEGIN[ A-Z]+PRIVATE KEY-----'''
tags = ["private", "key", "pem"]

[[rules]]
id = "generic-secret"
description = "Generic Secret or Password"
regex = '''(?i)(secret|password|passwd|pwd)\s*[:=]\s*['""].{8,}['"]'''
tags = ["secret", "password"]

[[rules]]
id = "broker-credentials"
description = "MetaTrader Broker Credentials"
regex = '''(?i)(login|account|server)\s*[:=]\s*['""].+['"]'''
path = '''.*mt4_credentials\.json$'''
tags = ["metatrader", "credentials"]

# Allow list: Files and patterns to exclude from scanning
[allowlist]
description = "Allowlisted files and patterns"

# Ignore git internal files
paths = [
    '''^\.git/''',
]

# Allow common file types that don't contain secrets
regexes = [
    '''(.*?)(jpg|gif|png|svg|ico)$''',
    '''(.*?)(woff|woff2|ttf|eot)$''',
    '''(.*?)(zip|tar|gz|bz2|7z)$''',
    '''(.*?)\.lock$''',
    '''(.*?)\.g\.dart$''',
    '''(.*?)\.freezed\.dart$''',
    '''(.*?)\.md$''',
    '''test/fixtures/.*''',
    '''(.*?)\.template$''',
    '''(.*?)\.example$''',
    '''(.*?)(apk|aab|so|dylib|dll)$''',
    '''build/.*''',
]

# Specific files to allow (known false positives)
files = [
    '''android/key.properties.template''',
    '''.gitleaks.toml''',
    '''PR-.*-PLAN\.md''',
    '''CHANGELOG\.md''',
    '''README\.md''',
]

# Stop words: Patterns that indicate a false positive
stopwords = [
    "password",
    "secret",
    "token",
    "key",
    "example",
    "placeholder",
    "your-",
    "<your-",
    "changeme",
    "replace",
    "docs",
    "documentation",
]
